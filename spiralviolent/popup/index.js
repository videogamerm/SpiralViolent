(e=>{function t(t){for(var a,o,r=t[0],l=t[1],c=t[2],d=0,u=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&u.push(s[o][0]),s[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(p&&p(t);u.length;)u.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,r=1;r<n.length;r++){var l=n[r];0!==s[l]&&(a=!1)}a&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},s={8:0},i=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=(e,t,n)=>{o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=(e,t)=>{if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,(t=>e[t]).bind(null,a));return n},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,"a",t),t},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.p="";var r=window.webpackJsonp=window.webpackJsonp||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var p=l;i.push([178,1,3,0]),n()})({176:(e,t,n)=>{"use strict";var a=n(53);n.n(a).a},178:function(e,t,n){"use strict";n.r(t);var a=n(27),s=n(0),i=n(2),o=n(33),r=n(57),l=n(1),c=n(29),p=(n(62),n(3)),d=n.n(p),u=n(20),m=n.n(u),b=n(5),f=n(24);const g={cache:{},scripts:[],frameScripts:[],commands:[],domain:"",injectionFailure:null,injectable:!0,blacklisted:!1},h={isApplied:b.a.get("isApplied"),filtersPopup:b.a.get("filtersPopup")||{}};b.a.hook(e=>{"isApplied"in e&&(h.isApplied=e.isApplied),"filtersPopup"in e&&(h.filtersPopup=d()({},h.filtersPopup,{},e.filtersPopup))});var v={components:{Icon:f.a,Tooltip:m.a},data:()=>({store:g,options:h,activeMenu:"scripts",message:null}),computed:{injectionScopes(){const{sort:e,enabledFirst:t,hideDisabled:n}=this.options.filtersPopup,a="alpha"===e||t;return[g.injectable&&["scripts",Object(s.m)("menuMatchedScripts")],["frameScripts",Object(s.m)("menuMatchedFrameScripts")]].filter(Boolean).map(([i,o])=>{let r=this.store[i];const l=r.length,c=r.reduce((e,t)=>e+t.config.enabled,0);return n&&(r=r.filter(e=>e.config.enabled)),r=r.map((n,i)=>{const o=n.custom.name||Object(s.k)(n.meta,"name");return{name:o,data:n,key:a&&`${t&&+!n.config.enabled}${"alpha"===e?o.toLowerCase():`${1e6+i}`.slice(1)}`}}),a&&r.sort((e,t)=>e.key<t.key?-1:e.key>t.key),l&&{name:i,title:o,list:r,totals:c<l?`${c} / ${l}`:`${l}`}}).filter(Boolean)},failureReason:()=>[!g.injectable&&"noninjectable",g.blacklisted&&"blacklisted",!1===h.isApplied&&"scripts-disabled"].filter(Boolean).join(" "),failureReasonText:()=>!g.injectable&&Object(s.m)("failureReasonNoninjectable")||g.blacklisted&&Object(s.m)("failureReasonBlacklisted")||!1===h.isApplied&&Object(s.m)("menuScriptDisabled")||""},methods:{toggleMenu(e){this.activeMenu=this.activeMenu===e?null:e},getSymbolCheck:e=>`toggle-${e?"on":"off"}`,scriptIconError(e){e.target.removeAttribute("src")},onToggle(){b.a.set("isApplied",!this.options.isApplied),this.checkReload()},onManage(){browser.runtime.openOptionsPage(),window.close()},onVisitWebsite(){Object(s.v)("TabOpen",{url:"https://violentmonkey.github.io/"}),window.close()},onEditScript(e){Object(s.v)("TabOpen",{url:`/options/index.html#scripts/${e.data.props.id}`,maybeInWindow:!0}),window.close()},onFindSameDomainScripts(){Object(s.v)("TabOpen",{url:`https://greasyfork.org/scripts/by-site/${encodeURIComponent(this.store.domain)}`}),window.close()},onCommand(e,t){Object(s.x)(g.currentTab.id,"Command",`${e}:${t}`)},onToggleScript(e){const{data:t}=e,n=!t.config.enabled;Object(s.v)("UpdateScriptInfo",{id:t.props.id,config:{enabled:n}}).then(()=>{t.config.enabled=n,this.checkReload()})},checkReload(){b.a.get("autoReload")&&browser.tabs.reload(this.store.currentTab.id)},async onCreateScript(){const{currentTab:e,domain:t}=this.store,n=t&&await Object(s.v)("CacheNewScript",{url:e.url.split(/[#?]/)[0],name:`- ${t}`});Object(s.v)("TabOpen",{url:`/options/index.html#scripts/_new${n?`/${n}`:""}`,maybeInWindow:!0}),window.close()},async onInjectionFailureFix(){b.a.set("defaultInjectInto",i.d),await Object(s.r)(100),await browser.tabs.reload(),window.close()}}},y=(n(176),n(4)),C=Object(y.a)(v,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"page-popup",attrs:{"data-failure-reason":e.failureReason}},[n("div",{staticClass:"flex menu-buttons"},[n("div",{staticClass:"logo",class:{disabled:!e.options.isApplied}},[n("img",{attrs:{src:"/public/images/icon128.png"}})]),n("div",{staticClass:"flex-1 ext-name",class:{disabled:!e.options.isApplied},domProps:{textContent:e._s(e.i18n("extName"))}}),n("tooltip",{staticClass:"menu-area",class:{disabled:!e.options.isApplied},attrs:{content:e.options.isApplied?e.i18n("menuScriptEnabled"):e.i18n("menuScriptDisabled"),placement:"bottom",align:"end"},nativeOn:{click:t=>e.onToggle(t)}},[n("icon",{attrs:{name:e.getSymbolCheck(e.options.isApplied)}})],1),n("tooltip",{staticClass:"menu-area",attrs:{content:e.i18n("menuDashboard"),placement:"bottom",align:"end"},nativeOn:{click:t=>e.onManage(t)}},[n("icon",{attrs:{name:"cog"}})],1),n("tooltip",{staticClass:"menu-area",attrs:{content:e.i18n("menuNewScript"),placement:"bottom",align:"end"},nativeOn:{click:t=>e.onCreateScript(t)}},[n("icon",{attrs:{name:"plus"}})],1)],1),e.store.injectable?n("div",{directives:[{name:"show",rawName:"v-show",value:e.store.domain,expression:"store.domain"}],staticClass:"menu"},[n("div",{staticClass:"menu-item menu-area menu-find",on:{click:e.onFindSameDomainScripts}},[n("icon",{attrs:{name:"search"}}),n("div",{staticClass:"flex-1",domProps:{textContent:e._s(e.i18n("menuFindScripts"))}})],1)]):e._e(),e.failureReasonText?n("div",{staticClass:"failure-reason"},[n("span",{domProps:{textContent:e._s(e.failureReasonText)}}),e.store.blacklisted?n("code",{staticClass:"ellipsis inline-block",domProps:{textContent:e._s(e.store.blacklisted)}}):e._e()]):e._e(),e._l(e.injectionScopes,t=>n("div",{key:t.name,staticClass:"menu menu-scripts",class:{expand:e.activeMenu===t.name},attrs:{"data-type":t.name}},[n("div",{staticClass:"menu-item menu-area menu-group",on:{click:n=>e.toggleMenu(t.name)}},[n("div",{staticClass:"flex-auto",attrs:{"data-totals":t.totals},domProps:{textContent:e._s(t.title)}}),n("icon",{staticClass:"icon-collapse",attrs:{name:"arrow"}})],1),n("div",{staticClass:"submenu"},e._l(t.list,(t,a)=>n("div",{key:a,class:{disabled:!t.data.config.enabled},on:{mouseenter:n=>{e.message=t.name},mouseleave:t=>{e.message=""}}},[n("div",{staticClass:"menu-item menu-area",on:{click:n=>e.onToggleScript(t)}},[n("img",{staticClass:"script-icon",attrs:{src:t.data.safeIcon},on:{error:e.scriptIconError}}),n("icon",{attrs:{name:e.getSymbolCheck(t.data.config.enabled)}}),n("div",{staticClass:"flex-auto ellipsis",class:{failed:t.data.failed},domProps:{textContent:e._s(t.name)},on:{click:n=>n.ctrlKey?n.shiftKey||n.altKey||n.metaKey?null:(n.stopPropagation(),e.onEditScript(t)):null,contextmenu:n=>n.ctrlKey||n.shiftKey||n.altKey||n.metaKey?null:(n.stopPropagation(),e.onEditScript(t)),mousedown:n=>"button"in n&&1!==n.button||n.ctrlKey||n.shiftKey||n.altKey||n.metaKey?null:(n.stopPropagation(),e.onEditScript(t))}})],1),n("div",{staticClass:"submenu-buttons"},[n("div",{staticClass:"submenu-button",attrs:{title:e.i18n("buttonEditClickHint")},on:{click:n=>e.onEditScript(t)}},[n("icon",{attrs:{name:"code"}})],1)]),n("div",{staticClass:"submenu-commands"},e._l(e.store.commands[t.data.props.id],(a,s)=>n("div",{key:s,staticClass:"menu-item menu-area",on:{click:n=>e.onCommand(t.data.props.id,a),mouseenter:t=>{e.message=a},mouseleave:n=>{e.message=t.name}}},[n("icon",{attrs:{name:"command"}}),n("div",{staticClass:"flex-auto ellipsis",domProps:{textContent:e._s(a)}})],1)),0)])),0)])),e.store.injectionFailure?n("div",{staticClass:"failure-reason"},[n("div",{domProps:{textContent:e._s(e.i18n("menuInjectionFailed"))}}),e.store.injectionFailure.fixable?n("a",{attrs:{href:"#"},domProps:{textContent:e._s(e.i18n("menuInjectionFailedFix"))},on:{click:t=>(t.preventDefault(),e.onInjectionFailureFix(t))}}):e._e()]):e._e(),e.store.currentTab&&e.store.currentTab.incognito?n("div",{staticClass:"incognito",domProps:{textContent:e._s(e.i18n("msgIncognitoChanges"))}}):e._e(),n("footer",[n("span",{domProps:{textContent:e._s(e.i18n("visitWebsite"))},on:{click:e.onVisitWebsite}})]),e.message?n("div",{staticClass:"message"},[n("div",{domProps:{textContent:e._s(e.message)}})]):e._e()],2)}),[],!1,null,null,null).exports;c.c(),a.default.prototype.i18n=s.m;const j=new a.default({render:e=>e(C)}).$mount();document.body.append(j.$el);const w=[],k={};k.ready=new Promise(e=>{k.resolve=e,setTimeout(e,100)}),Object.assign(o.a,{async SetPopup(e,t){if(g.currentTab&&g.currentTab.id!==t.tab.id)return;const n=0===t.frameId;n||await k.ready;const a=e.ids.filter(e=>!w.includes(e));var o;if(w.push(...a),n&&(k.resolve(),g.commands=(o=e.menus,l.f).call(o,([,e])=>Object.keys(e).sort())),a.length){const t=g[n?"scripts":"frameScripts"],o=e.metas||await Object(s.w)("GetMetas",a);o.forEach(e=>Object(r.a)(e,{cache:g.cache})),t.push(...o),e.failedIds.forEach(n=>{t.forEach(t=>{t.props.id===n&&(t.failed=!0,g.injectionFailure||(g.injectionFailure={fixable:e.injectInto===i.f}))})})}}}),Object(s.w)("CachePop","SetPopup").then(e=>{l.e.call(e,e=>o.a.SetPopup(...e))}),Object(s.i)().then(async e=>{const{url:t}=e;if(g.currentTab=e,browser.runtime.connect({name:`${e.id}`}),/^https?:\/\//i.test(t)){const e=t.match(/:\/\/([^/]*)/)[1];g.domain=c.a(e)||e}i.c.test(t)?g.blacklisted=await Object(s.w)("TestBlacklist",t):g.injectable=!1})},53:(e,t,n)=>{}});